<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="description" content="Personal Blog Of Gufran | Optimizing Laravel And Wardrobe Cms">
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="google-site-verification" content="jVNul_ZvsOPuGmV4Y85HMquZOpo8z0nH4ViodkMePpY">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="twitter:site" content="@freatbeater">
        <meta name="twitter:creator" content="@freatbeater">
        <meta property="og:type" content="article">
        <meta property="og:title" content="Blag Of A Programmer">
        <meta name="generator" content="Hodor">
        <link rel="canonical" href="http://www.gufran.me" />

        <title>Optimizing Laravel And Wardrobe Cms</title>

        <link rel="stylesheet" href="/css/build/style.201410072054.css">

        <script>
          (function(d) {
            var config = {
              kitId: 'mnk2fni',
              scriptTimeout: 3000
            },
            h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='//use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
          })(document);
        </script>
    </head>
    <body>
        <header id="mobile-header" class="visible-xs">
            <a id="home" href="http://www.gufran.me">
                <i class="icon-home"></i> Home
            </a>
            <label for="menu-button-check" class="nav-menu-button">
                <span></span>
                <span class="mid"></span>
                <span></span>
            </label>
        </header>
        <input type="checkbox" id="menu-button-check" class="hidden">
        <header id="main-header">
            <ul id="nav">
                <li class=" hidden-xs">
                    <a href="http://www.gufran.me">
                        <i class="icon-home"></i> Home
                    </a>
                </li>
                <li class="">
                    <a href="/tags/">
                        <i class="icon-tags"></i> Tags
                    </a>
                </li>
                <li>
                    <a href="#" class="contact-link" id="contact-section" target="_blank">
                        <i class="icon-mail"></i> Contact
                    </a>
                </li>
                <li>
                    <a href="http://github.com/Gufran" target="_blank">
                        <i class="icon-github"></i> Github
                    </a>
                </li>
                <li>
                    <a href="http://twitter.com/freatbeater" target="_blank">
                        <i class="icon-twitter"></i> Twitter
                    </a>
                </li>
            </ul>
        </header>
        <div id="main-contents">
<div class="single-post">
    <div class="container">
        <div class="post-item" itemscope itemtype="http://schema.org/BlogPosting" role="article">
            <div class="post-header">
                <div class="blog-no-header"></div>
            </div>
            <div class="post-body">
                <div class="meta">
                    <i class="icon-date"></i> 
                    <time itemprop="datePublished" datetime="02 April 2014" class="date">
                        02 April 2014
                    </time>
                </div>
                <h2 class="title" itemprop="name">Optimizing Laravel And Wardrobe Cms</h2>
                <div class="content" itemprop="description">
                    <p>Its time to talk about those optimisations I mentioned in my <a href="http://www.gufran.me/post/migration-from-wordpress-to-wardrobe-cms">previous post</a>.
Laravel already packs a punch in <code>php artisan optimise</code> command but ever since I moved my blog to WardrobeCMS I couldn&#39;t wait to experiment with things. This is not a company project after all, this is <em>My Blog</em> and I can break it a hundred gazillion times a day - No Questions.  </p>

<p>In my case I prepared a custom <em>minimal</em> Laravel setup from scratch with all required dependency defined explicitly, It was out of curiosity and to check how far things can be stretched with Laravel. You&#39;ll probably not need that so let&#39;s not complicate things right now, I&#39;ll talk about that process in a later article.  </p>

<p>Ok, lets dive in. In my case I am running <strong>WardrobeCMS</strong> from <strong>dev-master</strong> branch and <strong>Laravel</strong> version <strong>4.1.*</strong>, If you are below <code>4.0.1</code> then a couple things might not work for you or you may experience minor glitches here and there so before proceeding make sure we both are working on same thing.</p>

<h3>Remove The ServiceProviders</h3>

<p>I started with service providers array in <code>app/config/app.php</code> file. Just open the file and take a look at <code>providers</code> array, you can clean up a lot of it.<br>
In your application you probably don&#39;t require the <code>Artisan</code> service (double check with your codebase), once you make sure you are not calling <code>Artisan</code> from inside your application just go ahead and comment out those service providers:</p>
<div class="highlight"><pre><code class="language-" data-lang=""><span class="c1">&#39;Illuminate\Foundation\Providers\ArtisanServiceProvider&#39;,</span>
<span class="c1">&#39;Illuminate\Session\CommandsServiceProvider&#39;,</span>
<span class="c1">&#39;Illuminate\Foundation\Providers\ConsoleSupportServiceProvider&#39;,</span>
<span class="c1">&#39;Illuminate\Database\MigrationServiceProvider&#39;,</span>
<span class="c1">&#39;Illuminate\Remote\RemoteServiceProvider&#39;,</span>
<span class="c1">&#39;Illuminate\Database\SeedServiceProvider&#39;,</span>
<span class="c1">&#39;Illuminate\Workbench\WorkbenchServiceProvider&#39;,</span>
</code></pre></div>
<p>This will disable a lot of <code>artisan</code> functionality, go ahead and run <code>php artisan</code> to check it out.<br>
Apart from those service providers I also removed</p>
<div class="highlight"><pre><code class="language-" data-lang=""><span class="c1">&#39;Illuminate\Queue\QueueServiceProvider&#39;,</span>
<span class="c1">&#39;Illuminate\Html\HtmlServiceProvider&#39;,</span>
</code></pre></div>
<p>because I know I do not need them on my blog. You can safely remove them if you are running only WardrobeCMS.</p>

<h3>Add Them Back</h3>

<p>Next, we will place those service providers back but only for <code>artisan</code> this time. That means all those service providers will only be invoked if and only if <code>artisan</code> is invoked.<br>
Open up the <code>app/start/artisan.php</code> file and create an array of those service providers, then register them with <code>App::register()</code>, like this:</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$providers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;Illuminate\Foundation\Providers\ArtisanServiceProvider&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Illuminate\Session\CommandsServiceProvider&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Illuminate\Foundation\Providers\ConsoleSupportServiceProvider&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Illuminate\Database\MigrationServiceProvider&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Illuminate\Remote\RemoteServiceProvider&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Illuminate\Database\SeedServiceProvider&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Illuminate\Workbench\WorkbenchServiceProvider&#39;</span><span class="p">,</span>
<span class="p">);</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$providers</span> <span class="k">as</span> <span class="nv">$provider</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">App</span><span class="o">::</span><span class="na">register</span><span class="p">(</span><span class="nv">$provider</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Now those service providers will only be registered with artisan console. This is already pretty big improvement if you ask me but there more.  </p>

<h3>Squeeze The App Into One File</h3>

<p>Next up, lets register a couple of classes for optimised loading. Open up the file at <code>app/config/compile.php</code> and add wardrobe classes.<br>
Wardrobe is pretty small codebase, you can add almost everything in here to crunch and squeeze it into a single file but in my case I left out the controller class. Adding controller classes in here was generating a bizarre error message with no traceback so I still haven&#39;t figured out the exact reason for it, if you know how to fix that it please let me know in comments.<br>
I added these files in <code>app/config/compile.php</code></p>
<div class="highlight"><pre><code class="language-" data-lang=""><span class="vg">__DIR__</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="c1">&#39;/../../vendor/wardrobe/core/src/Wardrobe/Core/Repositories/DbPostRepository.php&#39;,</span>
<span class="vg">__DIR__</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="c1">&#39;/../../vendor/wardrobe/core/src/Wardrobe/Core/Repositories/DbUserRepository.php&#39;,</span>
<span class="vg">__DIR__</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="c1">&#39;/../../vendor/wardrobe/core/src/Wardrobe/Core/Repositories/PostRepositoryInterface.php&#39;,</span>
<span class="vg">__DIR__</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="c1">&#39;/../../vendor/wardrobe/core/src/Wardrobe/Core/Repositories/UserRepositoryInterface.php&#39;,</span>
<span class="vg">__DIR__</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="c1">&#39;/../../vendor/wardrobe/core/src/Wardrobe/Core/Models/BaseModel.php&#39;,</span>
<span class="vg">__DIR__</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="c1">&#39;/../../vendor/wardrobe/core/src/Wardrobe/Core/Models/Post.php&#39;,</span>
<span class="vg">__DIR__</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="c1">&#39;/../../vendor/wardrobe/core/src/Wardrobe/Core/Models/Tag.php&#39;,</span>
<span class="vg">__DIR__</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="c1">&#39;/../../vendor/wardrobe/core/src/Wardrobe/Core/Models/User.php&#39;,</span>
</code></pre></div>
<p>After saving the file you&#39;ll need to run</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">php artisan optimize --force
</code></pre></div>
<p>You may need that <code>--force</code> switch depending on <code>debug</code> element in <code>app/config/app.php</code> file,  if you have <code>debug</code> on then you need <code>--force</code> switch otherwise it is ok to leave it off.</p>

<p>This is basically all you need to pack all of WardrobeCMS into a single file and running laravel with minimum components loaded in memory.<br>
Wardrobe make use of caching heavily so you don&#39;t need to worry about things any further.</p>

<h3>And You&#39;re Done</h3>

<p>Enjoy the speed. </p>

                </div> 
            </div>
            <div class="post-tags">
                <i class="icon-tags"></i>
                
                <a class="tag_list_link" href="/tag/Laravel">Laravel</a>
                <span class="seperator">|</span>
                
                <a class="tag_list_link" href="/tag/Optimisation">Optimisation</a>
                <span class="seperator">|</span>
                
            </div>
            <ul class="post-socials">
                <li><a href="https://www.facebook.com/sharer/sharer.php?u=http://www.gufran.me/post/optimizing-laravel-and-wardrobe-cms&t=Optimizing Laravel And Wardrobe Cms" target="_blank"><i class="icon-facebook"></i></a></li>
                <li><a href="https://twitter.com/intent/tweet?original_referer=http://www.gufran.me/post/optimizing-laravel-and-wardrobe-cms&text=Optimizing Laravel And Wardrobe Cms&url=http://www.gufran.me/post/optimizing-laravel-and-wardrobe-cms" target="_blank"><i class="icon-twitter"></i></a></li>
                <li><a href="https://plus.google.com/share?url=http://www.gufran.me/post/optimizing-laravel-and-wardrobe-cms" target="_blank"><i class="icon-google-plus"></i></a></li>
            </ul>
            <div id="disqus_thread" itemprop="comment"></div>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments.</a></noscript>
        </div>
    </div>
    <div id="blog-pagination">
        <ul>
        	 
            <li class="prev"><a href="http://www.gufran.me/post/laravel-components"><i class="icon-arrow-left"></i><span>Prev</span></a></li>
            
             
            <li class="separator"></li>
            
             
            <li class="next"><a href="http://www.gufran.me/post/laravel-illuminate-support-package-introduction"><span>Next</span><i class="icon-arrow-right"></i></a></li>
            
        </ul>
    </div>
</div>
<script>
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//gufran-me.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
 </div>
       <footer>
        <div class="author">
          <div class="container">
            <div class="row" itemscope itemprop="author" itemtype="http://schema.org/Person">
              <div class="col-md-4 col-sm-3 hidden-xs">
                <img class="avatar" itemprop="image" src="http://www.gravatar.com/avatar/61a886b6d8b8e349a0ad8624992bc716?s=500" alt="Gufran">
              </div>
              <div class="col-md-8 col-sm-9">
                <p><em>Hi, there!</em> My name is <span itemprop="name">Mohammad Gufran</span>.</p>
                <p itemprop="description">I am a <span itemprop="jobTitle">programmer</span> who create things for web. Most of my time is spent in front of my computer browsing the web and writing codes for next cool project. I am a lifelong learner.<br/>You can contact me using email or send me a tweet.</p>
                <div class="row" role="contentinfo">
                  <div class="col-md-3 col-sm-3 social-button">
                    <a class="author-link" rel="author" href="http://github.com/Gufran" target="_blank">
                      <i class="icon-github"></i> github
                    </a>
                  </div>
                  <div class="col-md-3 col-sm-3 social-button">
                    <a class="author-link" rel="author" href="http://twitter.com/freatbeater" target="_blank">
                      <i class="icon-twitter"></i> twitter
                    </a>
                  </div>
                  <div class="col-md-3 col-sm-3 social-button">
                    <a class="author-link" rel="author" href="http://plus.google.com/+GufranKhan24" target="_blank">
                      <i class="icon-google-plus"></i> google+
                    </a>
                  </div>
                  <div class="col-md-3 col-sm-3 social-button">
                    <a class="author-link contact-link" href="#" target="_blank">
                      <i class="icon-mail"></i> contact
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="bottom">
            <div class="container">
                <div id="copyright">All content, unless specified otherwise,  is available under <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Common License with Attribution and Share Alike</a></div>
            </div>
        </div>   
       </footer> 
       <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
       <script type="text/javascript" src="/js/custom.201410072054.js"></script>   
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-46671921-1', 'gufran.me');
        ga('require', 'displayfeatures');
        ga('send', 'pageview');
      </script>
    </body>
</html>