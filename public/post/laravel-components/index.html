<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="description" content="Personal Blog Of Gufran | Laravel Components">
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="google-site-verification" content="jVNul_ZvsOPuGmV4Y85HMquZOpo8z0nH4ViodkMePpY">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="twitter:site" content="@freatbeater">
        <meta name="twitter:creator" content="@freatbeater">
        <meta property="og:type" content="article">
        <meta property="og:title" content="Blag Of A Programmer">
        <meta name="generator" content="Hodor">
        <link rel="canonical" href="http://www.gufran.me" />

        <title>Laravel Components</title>

        <link rel="stylesheet" href="/css/build/style.201410072054.css">

        <script>
          (function(d) {
            var config = {
              kitId: 'mnk2fni',
              scriptTimeout: 3000
            },
            h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='//use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
          })(document);
        </script>
    </head>
    <body>
        <header id="mobile-header" class="visible-xs">
            <a id="home" href="http://www.gufran.me">
                <i class="icon-home"></i> Home
            </a>
            <label for="menu-button-check" class="nav-menu-button">
                <span></span>
                <span class="mid"></span>
                <span></span>
            </label>
        </header>
        <input type="checkbox" id="menu-button-check" class="hidden">
        <header id="main-header">
            <ul id="nav">
                <li class=" hidden-xs">
                    <a href="http://www.gufran.me">
                        <i class="icon-home"></i> Home
                    </a>
                </li>
                <li class="">
                    <a href="/tags/">
                        <i class="icon-tags"></i> Tags
                    </a>
                </li>
                <li>
                    <a href="#" class="contact-link" id="contact-section" target="_blank">
                        <i class="icon-mail"></i> Contact
                    </a>
                </li>
                <li>
                    <a href="http://github.com/Gufran" target="_blank">
                        <i class="icon-github"></i> Github
                    </a>
                </li>
                <li>
                    <a href="http://twitter.com/freatbeater" target="_blank">
                        <i class="icon-twitter"></i> Twitter
                    </a>
                </li>
            </ul>
        </header>
        <div id="main-contents">
<div class="single-post">
    <div class="container">
        <div class="post-item" itemscope itemtype="http://schema.org/BlogPosting" role="article">
            <div class="post-header">
                <div class="blog-no-header"></div>
            </div>
            <div class="post-body">
                <div class="meta">
                    <i class="icon-date"></i> 
                    <time itemprop="datePublished" datetime="02 April 2014" class="date">
                        02 April 2014
                    </time>
                </div>
                <h2 class="title" itemprop="name">Laravel Components</h2>
                <div class="content" itemprop="description">
                    <p>It happens quite a lot of time with me that I have to sort out some legacy codes. Every time I am assigned the task I get told that these <em>&#39;codes works, just improve them&#39;</em>.<br>
I don&#39;t mind the language of a stupid creature who knows nothing about programming, I can&#39;t expect them to phrase - <em>&#39;This is the logic we want. We somehow managed to stuff all of it into a shitload of crap one could possibly create with PHP, just sort it out if you want money&#39;</em> - correctly.</p>

<p>Anyways, to the hell with their working codes. First thing that I do with these codes is I pull in my toolbox. I pull in some Laravel, and you guess it - I get <em>paid</em>.</p>

<p>This is no big secret anymore that you can pull in whichever part of Laravel you want into your project, leaving those off your project does not require. But many people either does not know the fact or despite of knowing it they prefer to pull in the entire codebase making their application 99% Laravel and 1% <em>their Application.</em> Not anymore. Let&#39;s quickly run down through few simple steps to leverage the <em>IoC container</em> and some magic dust offered by Laravel.</p>

<p><strong>If you are returning here for something you forgot to take note of or you don&#39;t have time to read through all of it, there is a TL;DR version <a href="#tldr">here</a></strong></p>

<p>We will start with an empty project so create a directory in your workspace and name it whatever the word is stuck in your mind for past few weeks! Yeah, doesn&#39;t really matter. I&#39;ll call mine <strong>Illuminated.</strong></p>

<p>Fire up the terminal and initialise composer:</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">composer init
</code></pre></div>
<p>and leave off the dependencies part for now, we&#39;ll add them in manually.</p>

<p>At this point we have some rotten codes which apparently works and a <code>composer.json</code> file in our project directory. Now is the time to pull in the components.<br>
If you perform a thorough search for <code>Illuminate</code> on <a href="http://packagist.org">packagist</a> website you&#39;ll see a lot of packages, all of them which starts with <code>Illuminate/***</code> are Laravel components that you can <em>just use.</em> Yeah really, it does however require a little bit of configuration but it is mostly trivial stuff. Lets search for <code>Illuminate/Container</code> and <code>Illuminate/Support</code> packages.</p>

<p><code>Illuminate/Container</code> package is that so called <em>IoC</em> container of Laravel where most of the sorcery takes place, and <code>Illuminate/Support</code> is the component which provides us with <code>Fluent</code> arrays, <code>Collection</code> array, <code>Str</code> class and all of these <code>array</code> and <code>string</code> helper functions you are used to (or maybe not! welcome to Laravel).</p>

<p>Update the <code>composer.json</code> file and add these dependencies in <code>required</code> section:</p>
<div class="highlight"><pre><code class="language-" data-lang=""><span class="w">    </span><span class="s2">&quot;illuminate/support&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;4.2.*@dev&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;illuminate/container&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;4.2.*@dev&quot;</span>
</code></pre></div>
<p>Notice that I&#39;m using the bleeding edge release from <code>development</code> branch just to check out some new features, you might want to change that to <strong>4.1.*</strong> if you need stable version. Run <code>composer install</code> to pull them in.<br>
Now that you are done with a mug of coffee and discussing the politics and business with people around you, composer should hopefully be finished installing the dependencies. We can now use them in our project.</p>

<p>Time to create an <code>index.php</code> file in your project root. You may want to create a few more directories like <code>Controllers</code>, <code>Models</code> etc. all of which we can register in Laravel&#39;s autoloader.<br>
In <code>index.php</code> file require the autoloader provided by composer (<code>&#39;vendor/autoload.php&#39;</code>) at top. And while we are at it let&#39;s also require the <code>helpers.php</code> file provided by <code>Support</code> package. This file should be located at <code>vendor/illuminate/support/illuminate/support/helpers.php</code> (Yes, you read that right). Our index file at this time should look like this:</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">require</span> <span class="s1">&#39;./vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">require</span> <span class="s1">&#39;./vendor/illuminate/support/illuminate/support/helpers.php&#39;</span><span class="p">;</span>
</code></pre></div>
<p>After that we need to register the class autoloader provided by Laravel.<br>
Laravel&#39;s class autoloader is provided by <code>Illuminate/Support</code> package and class resides at <code>Illuminate/Support/ClassLoader</code>. Take a look through the codes if you want to (I&#39;d highly recommend that you do) and then we move on.<br>
To register the autoloader all it takes is a simple static call to <code>register()</code> method:</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">require</span> <span class="s1">&#39;./vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">require</span> <span class="s1">&#39;./vendor/illuminate/support/illuminate/support/helpers.php&#39;</span><span class="p">;</span>

<span class="nx">Illuminate\Support\ClassLoader</span><span class="o">::</span><span class="na">register</span><span class="p">();</span>
</code></pre></div>
<p>It would be a good idea to define some path variables now so that we can use them throughout the script, I&#39;d define just the <code>$basePath</code> variable which points to the root of the project, we can use it to build other path as required.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="c1">// use the str_finish helper method to assure a trailing slash at the end of path string</span>

<span class="nv">$basePath</span> <span class="o">=</span> <span class="nx">str_finish</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>

<span class="c1">// if you have other directories define the path to them too</span>
<span class="nv">$libraries</span> <span class="o">=</span> <span class="nv">$basePath</span> <span class="o">.</span> <span class="s1">&#39;Libraries&#39;</span><span class="p">;</span>
<span class="nv">$services</span> <span class="o">=</span> <span class="nv">$basePath</span> <span class="o">.</span> <span class="s1">&#39;Services&#39;</span><span class="p">;</span>
</code></pre></div>
<p>and now you can register these directories into the autoloader with the help of <code>addDirectories()</code> method:</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nx">Illuminate\Support\ClassLoader</span><span class="o">::</span><span class="na">addDirectories</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="nv">$libraries</span><span class="p">,</span> <span class="nv">$services</span><span class="p">));</span>
</code></pre></div>
<p>So far so good.<br>
We are ready to instantiate the container, let do that now. We will create an <code>$app</code> object of <code>Container</code> class:</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Illuminate\Container\Container</span><span class="p">();</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="nv">$app</span><span class="p">);</span>

<span class="c1">// also bind the base path for some helper methods to use</span>
<span class="c1">// Overcome the mental block, you can bind literally anything into the container</span>

<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;path.base&#39;</span><span class="p">,</span> <span class="nv">$basePath</span><span class="p">);</span>
</code></pre></div>
<p>Pretty good. We now have an instance of Container ready to serve the magic - but - what about that <code>$app-&gt;bind(&#39;app&#39;, $app)</code> part ? Nothing fancy, we are register the application instance into IoC container.</p>

<p>We need to also register the application instance into Facade class to get out <code>app()</code> helper function running:</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="c1">// Yes, that is an abstract class but you can still access </span>
<span class="c1">// static methods</span>
<span class="nx">Illuminate\Support\Facades\Facade</span><span class="o">::</span><span class="na">setFacadeApplication</span><span class="p">(</span><span class="nv">$app</span><span class="p">);</span>
</code></pre></div>
<p>Now we can use <code>app()</code> method to retrieve the instance of application or <code>app(&#39;foo&#39;)</code> to resolve the <code>foo</code> binding.</p>

<p>After this point things should be so predictable for anyone who is using Laravel for long enough to know about <code>App::bind()</code> and <code>App::make()</code> methods. If you are not one of them, well, shame on you, go read the <a href="http://laravel.com/docs/ioc">documentations</a> dammit.</p>

<h3><a name="tldr"></a>TL;DR</h3>

<p>Here is what we did so far. Add dependencies in your <code>composer.json</code> file</p>
<div class="highlight"><pre><code class="language-" data-lang=""><span class="w">    </span><span class="s2">&quot;illuminate/support&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;4.2.*@dev&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;illuminate/container&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;4.2.*@dev&quot;</span>
</code></pre></div>
<p>In <code>index.php</code> file register the autoloaders and instantiate the container. Also register project directories into the autoloader.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="k">require</span> <span class="s1">&#39;./vendor/autoload.php&#39;</span><span class="p">;</span>
<span class="k">require</span> <span class="s1">&#39;./vendor/illuminate/support/illuminate/support/helpers.php&#39;</span><span class="p">;</span>

<span class="c1">// Register laravel&#39;s autoloader</span>
<span class="nx">Illuminate\Support\ClassLoader</span><span class="o">::</span><span class="na">register</span><span class="p">();</span>

<span class="c1">// use the str_finish helper method to assure a trailing slash at the end of path string</span>
<span class="nv">$basePath</span> <span class="o">=</span> <span class="nx">str_finish</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>

<span class="c1">// if you have other directories define the path to them too</span>
<span class="nv">$libraries</span> <span class="o">=</span> <span class="nv">$basePath</span> <span class="o">.</span> <span class="s1">&#39;Libraries&#39;</span><span class="p">;</span>
<span class="nv">$services</span> <span class="o">=</span> <span class="nv">$basePath</span> <span class="o">.</span> <span class="s1">&#39;Services&#39;</span><span class="p">;</span>

<span class="c1">// register directories into autoloader</span>
<span class="nx">Illuminate\Support\ClassLoader</span><span class="o">::</span><span class="na">addDirectories</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="nv">$libraries</span><span class="p">,</span> <span class="nv">$services</span><span class="p">));</span>

<span class="c1">// instantiate the container</span>
<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Illuminate\Container\Container</span><span class="p">();</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="nv">$app</span><span class="p">);</span>

<span class="c1">// also bind the base path for some helper methods to use</span>
<span class="c1">// Overcome the mental block, you can bind literally anything into the container</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;path.base&#39;</span><span class="p">,</span> <span class="nv">$basePath</span><span class="p">);</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;path.libraries&#39;</span><span class="p">,</span> <span class="nv">$libraries</span><span class="p">);</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">bind</span><span class="p">(</span><span class="s1">&#39;path.services&#39;</span><span class="p">,</span> <span class="nv">$services</span><span class="p">);</span>

<span class="c1">// set application instance on Facade class so the helper methods</span>
<span class="c1">// can know about current instance of application</span>
<span class="nx">Illuminate\Support\Facades\Facade</span><span class="o">::</span><span class="na">setFacadeApplication</span><span class="p">(</span><span class="nv">$app</span><span class="p">);</span>

<span class="c1">// ------------------- Away you go ------------------- //</span>
<span class="c1">// Just make sure you namespace the classes properly and </span>
<span class="c1">// according to the directory structure so that the ClassLoader</span>
<span class="c1">// can find and load them</span>
</code></pre></div>
                </div> 
            </div>
            <div class="post-tags">
                <i class="icon-tags"></i>
                
                <a class="tag_list_link" href="/tag/IoC Component">IoC Component</a>
                <span class="seperator">|</span>
                
                <a class="tag_list_link" href="/tag/Laravel">Laravel</a>
                <span class="seperator">|</span>
                
                <a class="tag_list_link" href="/tag/Module">Module</a>
                <span class="seperator">|</span>
                
            </div>
            <ul class="post-socials">
                <li><a href="https://www.facebook.com/sharer/sharer.php?u=http://www.gufran.me/post/laravel-components&t=Laravel Components" target="_blank"><i class="icon-facebook"></i></a></li>
                <li><a href="https://twitter.com/intent/tweet?original_referer=http://www.gufran.me/post/laravel-components&text=Laravel Components&url=http://www.gufran.me/post/laravel-components" target="_blank"><i class="icon-twitter"></i></a></li>
                <li><a href="https://plus.google.com/share?url=http://www.gufran.me/post/laravel-components" target="_blank"><i class="icon-google-plus"></i></a></li>
            </ul>
            <div id="disqus_thread" itemprop="comment"></div>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments.</a></noscript>
        </div>
    </div>
    <div id="blog-pagination">
        <ul>
        	 
            <li class="prev"><a href="http://www.gufran.me/post/integrated-tests-are-a-scam"><i class="icon-arrow-left"></i><span>Prev</span></a></li>
            
             
            <li class="separator"></li>
            
             
            <li class="next"><a href="http://www.gufran.me/post/optimizing-laravel-and-wardrobe-cms"><span>Next</span><i class="icon-arrow-right"></i></a></li>
            
        </ul>
    </div>
</div>
<script>
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//gufran-me.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
 </div>
       <footer>
        <div class="author">
          <div class="container">
            <div class="row" itemscope itemprop="author" itemtype="http://schema.org/Person">
              <div class="col-md-4 col-sm-3 hidden-xs">
                <img class="avatar" itemprop="image" src="http://www.gravatar.com/avatar/61a886b6d8b8e349a0ad8624992bc716?s=500" alt="Gufran">
              </div>
              <div class="col-md-8 col-sm-9">
                <p><em>Hi, there!</em> My name is <span itemprop="name">Mohammad Gufran</span>.</p>
                <p itemprop="description">I am a <span itemprop="jobTitle">programmer</span> who create things for web. Most of my time is spent in front of my computer browsing the web and writing codes for next cool project. I am a lifelong learner.<br/>You can contact me using email or send me a tweet.</p>
                <div class="row" role="contentinfo">
                  <div class="col-md-3 col-sm-3 social-button">
                    <a class="author-link" rel="author" href="http://github.com/Gufran" target="_blank">
                      <i class="icon-github"></i> github
                    </a>
                  </div>
                  <div class="col-md-3 col-sm-3 social-button">
                    <a class="author-link" rel="author" href="http://twitter.com/freatbeater" target="_blank">
                      <i class="icon-twitter"></i> twitter
                    </a>
                  </div>
                  <div class="col-md-3 col-sm-3 social-button">
                    <a class="author-link" rel="author" href="http://plus.google.com/+GufranKhan24" target="_blank">
                      <i class="icon-google-plus"></i> google+
                    </a>
                  </div>
                  <div class="col-md-3 col-sm-3 social-button">
                    <a class="author-link contact-link" href="#" target="_blank">
                      <i class="icon-mail"></i> contact
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="bottom">
            <div class="container">
                <div id="copyright">All content, unless specified otherwise,  is available under <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative Common License with Attribution and Share Alike</a></div>
            </div>
        </div>   
       </footer> 
       <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
       <script type="text/javascript" src="/js/custom.201410072054.js"></script>   
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-46671921-1', 'gufran.me');
        ga('require', 'displayfeatures');
        ga('send', 'pageview');
      </script>
    </body>
</html>